function showText(t,e){let s=0,a="";for(let e of t.innerText)a+="<span>"+e+"</span>";t.innerHTML=a,setTimeout(()=>{let e=setInterval(()=>{t.children[s++].style.opacity="1",s>=t.children.length&&this.clearInterval(e)},100)},e)}function typeText(){let t=0,e=0,s=!0;setInterval(()=>{e>=0?textBox.innerText=s?content[t].substring(0,++e):content[t].substring(0,e--):e--,e>=content[t].length+8&&(s=!1),e<-10&&(t++,s=!0,e=0,t>=content.length&&(t=0))},150)}function mobileLoadStar(){const t=()=>(.3+.5*Math.random()).toFixed(1),e=(t,e)=>{let s=t+Math.random()*(e-t),a=2*Math.random()*Math.PI;return[s*Math.cos(a),s*Math.sin(a)]};for(let t=0;t<starsNums.starsInCenter;t++){let t=e(0,40);starsDOM+="<span class='star' style='transform:translate("+t[0]+"px,"+t[1]+"px); width:1px;height:1px;'></span>"}for(let t=0;t<starsNums.star1Nums;t++){let t=e(40,skySize/2);starsDOM+="<span class='star' style='transform:translate("+t[0]+"px,"+t[1]+"px); width:1px;height:1px;'></span>"}for(let s=0;s<starsNums.star2Nums;s++){let s=e(0,skySize/2.5);starsDOM+="<span class='star "+flashArray[getRandomIndex(4)]+"' style='transform:translate("+s[0]+"px,"+s[1]+"px); width:2px;height:2px;opacity:"+t+";'></span>"}for(let t=0;t<starsNums.star3Nums;t++){let t=e(0,skySize/2.5);starsDOM+="<span class='star "+colorArray[getRandomIndex(4)]+" "+flashArray[getRandomIndex(4)]+"' style='transform:translate("+t[0]+"px,"+t[1]+"px);width:3px;height:3px;'></span>"}starsDOM+="<span class='star2'></span>",starsDOM+="<span class='star3'></span>"}function PCLoadStar(){let t=2*Math.PI*Math.random(),e=50+15*Math.sin(t),s=50+15*Math.cos(t);for(let t=0;t<starsNums.star1Nums;t++)starsDOM+="<span class='star "+flashArray[getRandomIndex(4)]+"' style='transform:translate("+Math.random()*skySize+"px,"+Math.random()*skySize+"px);width:1px;height:1px;'></span>";for(let t=0;t<starsNums.star2Nums;t++)starsDOM+="<span class='star "+flashArray[getRandomIndex(4)]+"' style='transform:translate("+Math.random()*skySize+"px,"+Math.random()*skySize+"px);width:2px;height:2px;'></span>";for(let t=0;t<starsNums.star3Nums;t++)starsDOM+="<span class='star "+colorArray[getRandomIndex(4)]+" "+flashArray[getRandomIndex(4)]+"' style='transform:translate("+Math.random()*skySize+"px,"+Math.random()*skySize+"px);width:3px;height:3px;'></span>";starsDOM+=`<span class='star2' style='top:${e}%;left:${s}%;'></span>`,starsDOM+=`<span class='star3' style='bottom:${e}%;right:${s}%;'></span>`}function skyAction(){loadStar(),meteorTimer=setInterval(()=>{Math.random()>.8&&shootingStar()},5e3)}function shootingStar(){function t(){e.top<=page2Height?(e.fall(),requestAnimationFrame(t)):page2.removeChild(e.meteorDom)}let e=new Metor;e.init(),t()}function loadPage2(){main.style.top="-100vh",typeText(),skyAction(),sky.innerHTML=starsDOM}const mobile=navigator.userAgent.toLowerCase().match(/(phone|pad|ipod|iphone|android|mobile|MQQBrowser|JUC|coolpad|mmp|smartphone|midp|wap|xoom|symbian|j2me|blackberry|wince|windows Phone)/i),main=document.querySelector(".main"),door=document.querySelector(".door"),webTitle=document.querySelector(".webTitle"),subtitle=document.querySelector(".subtitle"),page2=document.querySelector(".page2"),textBox=document.querySelector(".textBox"),verse=document.querySelector(".verse"),sky=document.querySelector(".sky"),BgSwitch=document.querySelector("#BgSwitch");let meteorTimer=0,starsDOM="",page2Width=page2.offsetWidth,page2Height=page2.offsetHeight,skySize=Math.sqrt(Math.pow(page2Width,2)+Math.pow(page2Height,2));const flashArray=["flash1","flash2","flash3","flash4"],colorArray=["whiteStar","whiteStar","purpleStar","blueStar"],verseContent=["我们都生活在阴沟里，仍有人仰望星空","如果你瞄准月亮，即使迷失也是落在星河之间","月亮踩碎星光，我们都是藏于银河的幻想","春光恰与少年同，十里清风慕天青"],content=["技术&生活&分享&回忆","欢迎来到SHIWIVI的网站","推荐使用PC端谷歌浏览器访问","移动端下CSS样式会被阉割","服务器在国外,加载会有亿点点慢"],getRandomIndex=t=>Math.floor(Math.random()*t);window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFram||window.mozRequestAnimationFram||window.oRequestAnimationFram||window.msRequestAnimationFram||function(t){window.setTimeout(t,1e3/60)};let settings={PC:{offsetStar:-150,offsetScreen:0,loadStar:PCLoadStar,starsNums:{star1Nums:400,star2Nums:200,star3Nums:100}},mobile:{offsetStar:600,offsetScreen:200,loadStar:mobileLoadStar,starsNums:{starsInCenter:10,star1Nums:280,star2Nums:60,star3Nums:20}}},{offsetStar:offsetStar,offsetScreen:offsetScreen,loadStar:loadStar,starsNums:starsNums}=mobile?settings.mobile:settings.PC;class Metor{constructor(){this.top=-300,this.width=parseInt(200*Math.random()+800),this.right=-(Math.random()*(page2Width+offsetScreen)+offsetStar),this.meteorDom=document.createElement("div")}init(){this.meteorDom.className="meteor",this.meteorDom.style.width=this.width+"px",this.meteorDom.style.right=this.right+"px",this.meteorDom.style.top=this.top+"px",page2.appendChild(this.meteorDom)}fall(){this.top+=20,this.right+=20,this.meteorDom.style.right=this.right+"px",this.meteorDom.style.top=this.top+"px"}}new Promise(t=>{function e(s){("click"==s.type||s.deltaY>0)&&(loadPage2(),t(e))}door.addEventListener("click",e),main.addEventListener("wheel",e)}).then(t=>{main.removeEventListener("wheel",t),door.removeEventListener("click",t)}),document.addEventListener("visibilitychange",function(){"hidden"===document.visibilityState?document.title="这个页面会占用很多内存哦":(document.title="",setTimeout(function(){document.title="SHIWIVI"},3e3))}),BgSwitch.addEventListener("click",function(){0==BgSwitch.checked?(sky.innerHTML="",sky.style.display="none",clearInterval(meteorTimer)):(sky.style.display="block",starsDOM="",loadStar(),sky.innerHTML=starsDOM)}),window.addEventListener("load",function(){showText(webTitle,100),showText(subtitle,800),verse.innerText=verseContent[Math.round(Math.random()*(verseContent.length-1))],sky.style.width=sky.style.height=skySize+"px"});